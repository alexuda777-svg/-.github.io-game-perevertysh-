<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ –ü–µ—Ä–µ–≤–µ—Ä—Ç—ã—à: –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –í–æ–∑—Ä–∞—Å—Ç–æ–≤ (–†–ê–ë–û–¢–ê–ï–¢!)</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            background:linear-gradient(-45deg,#ff9a9e,#fecfef,#fecfef,#ff9a9e);
            background-size:400% 400%;animation:gradientShift 15s ease infinite;
            color:#333;font-family:'Comic Sans MS',cursive;min-height:100vh;overflow-x:hidden
        }
        @keyframes gradientShift{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
        .music-controls{position:fixed;top:20px;right:20px;z-index:10000;display:flex;gap:10px}
        .music-btn{background:#ff6b35;color:white;border:none;border-radius:50%;width:60px;height:60px;
            font-size:1.5em;cursor:pointer;box-shadow:0 5px 15px rgba(255,107,53,0.4);transition:all 0.3s}
        .music-btn:hover{transform:scale(1.1);box-shadow:0 8px 25px rgba(255,107,53,0.6)}
        .music-btn.active{background:#27ae60}
        .container{max-width:1000px;margin:0 auto;padding:20px}
        .header{text-align:center;background:linear-gradient(90deg,#ffd700,#ff6b35,#ffd700);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:3em;
            margin:20px 0;text-shadow:0 0 30px rgba(255,215,0,0.8);animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .status-bar{display:grid;grid-template-columns:1fr 1fr 1fr;gap:15px;background:#fff8dc;
            border-radius:25px;padding:20px;margin:20px 0;box-shadow:0 15px 40px rgba(0,0,0,0.2)}
        .stat-card{background:#fff;border-radius:15px;padding:15px;text-align:center;box-shadow:0 8px 25px rgba(0,0,0,0.1);
            transition:all 0.3s}.stat-card:hover{transform:translateY(-5px)}
        .character-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin:20px 0}
        .character-card{background:#fff;border-radius:20px;padding:20px;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,0.15);
            transition:all 0.4s ease}.character-card:hover{transform:scale(1.05)}
        .age-2{background:linear-gradient(135deg,#ffe4b5,#ffdab9)}
        .age-9{background:linear-gradient(135deg,#b8e6b8,#98d8a8)}
        .age-15{background:linear-gradient(135deg,#a8d5e2,#87c5d2)}
        .age-17{background:linear-gradient(135deg,#f4b6c2,#e8a2b0)}
        .scene-text{background:#fff;border-radius:25px;padding:30px;margin:25px 0;font-size:1.4em;
            line-height:1.8;box-shadow:0 20px 50px rgba(0,0,0,0.2);min-height:250px;max-height:400px;
            white-space:pre-wrap}
        .highlight{color:#ff6b35;font-weight:bold}
        .danger{color:#e74c3c;font-weight:bold}
        .success{color:#27ae60;font-weight:bold}
        .puzzle-screen{background:rgba(255,255,255,0.98);border-radius:25px;padding:40px;margin:20px 0;
            box-shadow:0 20px 60px rgba(0,0,0,0.3);text-align:center;display:none}
        .puzzle-screen.active{display:block}
        .puzzle-question{font-size:2em;margin:30px 0;font-weight:bold;color:#ff6b35}
        .puzzle-input{width:80%;max-width:400px;padding:20px;font-size:1.5em;border:3px solid #ffd700;
            border-radius:15px;text-align:center;margin:20px 0;font-family:'Comic Sans MS',cursive}
        .choices{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin:30px 0}
        button{background:linear-gradient(45deg,#ff6b35,#f7931e);color:white;border:none;border-radius:30px;
            padding:20px 35px;font-size:1.3em;font-weight:bold;cursor:pointer;transition:all 0.3s;
            box-shadow:0 10px 30px rgba(255,107,53,0.4);font-family:'Comic Sans MS',cursive}
        button:hover{transform:translateY(-5px);box-shadow:0 15px 40px rgba(255,107,53,0.6)}
        button:disabled{background:#bdc3c7;cursor:not-allowed}
        .hidden{display:none!important}
        .progress-bar{width:100%;height:20px;background:#ddd;border-radius:10px;overflow:hidden;margin:20px 0}
        .progress-fill{height:100%;background:linear-gradient(90deg,#27ae60,#2ecc71);width:0%;transition:width 1s ease}
    </style>
</head>
<body>
    <!-- –ú–£–ó–´–ö–ê -->
    <div class="music-controls">
        <button class="music-btn active" onclick="toggleMusic()" title="–ú—É–∑—ã–∫–∞">üéµ</button>
        <button class="music-btn" onclick="toggleSfx()" title="–ó–≤—É–∫–∏">üîä</button>
    </div>

    <div class="container">
        <h1 class="header">üé≤ –ü–µ—Ä–µ–≤–µ—Ä—Ç—ã—à: –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –í–æ–∑—Ä–∞—Å—Ç–æ–≤</h1>
        
        <div class="status-bar">
            <div class="stat-card">
                <div style="font-size:2em">üåü</div>
                <div>–£—Ä–æ–≤–µ–Ω—å</div>
                <div id="level">1</div>
            </div>
            <div class="stat-card">
                <div style="font-size:2em">üïê</div>
                <div>–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã</div>
                <div id="magic-count">0/6</div>
            </div>
            <div class="stat-card">
                <div style="font-size:2em">‚≠ê</div>
                <div>–û—á–∫–∏</div>
                <div id="score-value">0</div>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>

        <div class="character-grid" id="characters"></div>
        
        <div id="game-content">
            <div id="scene" class="scene-text">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...</div>
            <div id="choices" class="choices"></div>
        </div>

        <div id="puzzle-screen" class="puzzle-screen">
            <div class="puzzle-question" id="puzzle-question">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <input type="text" id="puzzle-input" class="puzzle-input" placeholder="–í–≤–µ–¥–∏ –æ—Ç–≤–µ—Ç...">
            <br><button onclick="checkPuzzleAnswer()">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å!</button>
            <div id="puzzle-hint"></div>
        </div>
    </div>

    <script>
        // –ì–õ–û–ë–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï
        const gameState = {
            level: 1, score: 0, magicItems: 0, currentScene: 'start', playTime: 0,
            currentPuzzle: null, musicEnabled: true, sfxEnabled: true,
            characters: {
                vova: {name: 'üë®‚Äçüíª –í–æ–≤–∞', age: 17, emoji: 'üë®‚Äçüíª'},
                arseniy: {name: 'üé∏ –ê—Ä—Å–µ–Ω–∏–π', age: 15, emoji: 'üé∏'},
                bogdan: {name: 'üîç –ë–æ–≥–¥–∞–Ω', age: 9, emoji: 'üîç'},
                mark: {name: 'üçº –ú–∞—Ä–∫', age: 2, emoji: 'üçº'}
            }
        };

        // ‚úÖ –ü–û–õ–ù–´–ï –°–¶–ï–ù–´
        const scenes = {
            start: {
                text: `üå≥ –ì–û–†–°–ö–û–ô –ü–ê–†–ö ‚Äî —è—Ä–∫–æ–µ –ª–µ—Ç–æ!

–í–æ–≤–∞(17)‚öΩ –∑–∞–±–∏–≤–∞–µ—Ç –≥–æ–ª—ã, –ê—Ä—Å–µ–Ω–∏–π(15)üéß –∫–∞—á–∞–µ—Ç –º—É–∑—ã–∫—É,
–ë–æ–≥–¥–∞–Ω(9)üß© —Å–æ–±–∏—Ä–∞–µ—Ç "–¢–∏—Ç–∞–Ω–∏–∫", –ú–∞—Ä–∫(2)üåø –∂—É–µ—Ç —Ç—Ä–∞–≤—É!

‚ùì –í –∫—É—Å—Ç–∞—Ö –¢–ò–ö–ê–Æ–¢ –î–†–ï–í–ù–ò–ï –ß–ê–°–´...
üåÄ –ú–ê–ì–ò–Ø –í–†–ï–ú–ï–ù–ò –ê–ö–¢–ò–í–ù–ê!
        
–¶–µ–ª—å: —Å–æ–±—Ä–∞—Ç—å 6 –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤!
–û—à–∏–±–∫–∞ = –í–æ–∑—Ä–∞—Å—Ç —É–≥–∞—Å–∞–µ—Ç (-2 –≥–æ–¥–∞!)
–£—Å–ø–µ—Ö = –í–æ–∑—Ä–∞—Å—Ç —Ä–∞—Å—Ç–µ—Ç (+3 –≥–æ–¥–∞!)`,
                choices: [
                    {text: "üï∞Ô∏è –ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨ –ß–ê–°–´", next: 'clockBoom'},
                    {text: "üß© –ó–ê–ì–ê–î–ö–ê –ü–ê–†–ö–ê", puzzle: 'logic'},
                    {text: "üèÉ –ë–ï–ñ–ê–¢–¨!", next: 'runAway'}
                ]
            },
            clockBoom: {
                text: `üåÄ –ë–£–£–£–ú! –ß–ê–°–´ –í–ó–û–†–í–ê–õ–ò–°–¨! ‚ö°

–í–æ–≤–∞(17‚Üí2) –ø–æ–ª–∑–∞–µ—Ç –∏ –ø–ª–∞—á–µ—Ç!
–ú–∞—Ä–∫(2‚Üí17) –∫–æ–¥–∏—Ç –Ω–∞ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–µ!
–ê—Ä—Å–µ–Ω–∏–π‚Üî–ë–æ–≥–¥–∞–Ω –ø–æ–º–µ–Ω—è–ª–∏—Å—å!

üíÄ –í–û–ó–†–ê–°–¢ –£–ì–ê –°–ê–ï–¢! 
1/6 –ê–†–¢–ï–§–ê–ö–¢–û–í ‚Äî –®–ö–û–õ–ê –∂–¥–µ—Ç!`,
                effect: 'randomAges',
                choices: [{text: "üè´ –í –®–ö–û–õ–£!", next: 'school1'}]
            },
            school1: {
                text: `üè´ –®–ö–û–õ–ê ‚Äî –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê!

–ú–∞—Ä–∫(17) —Ä–∏—Å—É–µ—Ç —Ñ–æ—Ä–º—É–ª—ã, –í–æ–≤–∞(2) –Ω–∞ –ø–æ–ª—É üò≠
–£—á–∏—Ç–µ–ª—å: "–†–ï–®–ò –£–†–ê–í–ù–ï–ù–ò–ï –ò–õ–ò –í–°–ï–ú –ù–û–õ–¨!"

1/6 –∞—Ä—Ç–µ—Ñ–∞–∫—Ç ‚Äî –ú–ê–ì–∏—á–µ—Å–∫–∏–π –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä!`,
                choices: [{text: "üßÆ –ú–ê–¢–ï–ó–ê–î–ê–ß–ê", puzzle: 'math'}]
            }
        };

        // ‚úÖ –ó–ê–î–ê–ß–ö–ò
        const puzzles = {
            math: [
                {q: "15 + 27 = ?", a: "42", hint: "–°–ª–æ–∂–∏ —á–∏—Å–ª–∞!"},
                {q: "8 –∫–æ–Ω—Ñ–µ—Ç - 3 = ?", a: "5", hint: "–°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å?"},
                {q: "2 + 1.5 = ?", a: "3.5", hint: "–í–æ–≤–∞ –±–µ–∂–∏—Ç!"}
            ],
            logic: [
                {q: "1–∫–≥ –ø–µ—Ä—å–µ–≤ –∏–ª–∏ 1–∫–≥ –∂–µ–ª–µ–∑–∞?", a: "–æ–¥–∏–Ω–∞–∫–æ–≤–æ", hint: "–û–±–∞ 1 –∫–≥!"},
                {q: "3 –ª–∞–º–ø–æ—á–∫–∏. –ö–∞–∫–∞—è –≥–æ—Ä–∏—Ç?", a: "–≤—Å–µ", hint: "–í—Å–µ –≤–∫–ª—é—á–µ–Ω—ã!"},
                {q: "12 –ø–∞–∑–ª–æ–≤ √ó 2 = ?", a: "24", hint: "–ë–æ–≥–¥–∞–Ω –º–∞—Å—Ç–µ—Ä!"}
            ]
        };

        // üéµ –ó–í–£–ö–ò (–≤–∏–±—Ä–∞—Ü–∏—è)
        function playSound(type) {
            if (navigator.vibrate && gameState.sfxEnabled) {
                navigator.vibrate(100);
            }
        }

        function toggleMusic() {
            gameState.musicEnabled = !gameState.musicEnabled;
            document.querySelector('.music-btn').classList.toggle('active', gameState.musicEnabled);
        }

        function toggleSfx() {
            gameState.sfxEnabled = !gameState.sfxEnabled;
            document.querySelectorAll('.music-btn')[1].classList.toggle('active', gameState.sfxEnabled);
        }

        // ‚úÖ –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ
        function initGame() {
            console.log('üöÄ –ò–ì–†–ê –ó–ê–ü–£–©–ï–ù–ê!');
            updateUI();
            showScene('start');
            setInterval(updateTimer, 1000);
        }

        function showScene(sceneName) {
            const scene = scenes[sceneName] || scenes.start;
            const sceneEl = document.getElementById('scene');
            
            sceneEl.textContent = '';
            typeWriter(scene.text, sceneEl, () => {
                showChoices(scene.choices || []);
                if (scene.effect) window[scene.effect]();
            });
        }

        function typeWriter(text, element, callback) {
            element.textContent = '';
            let i = 0;
            function type() {
                if (i < text.length) {
                    element.textContent += text[i];
                    i++;
                    setTimeout(type, 30);
                } else if (callback) {
                    callback();
                }
            }
            type();
        }

        function showChoices(choices) {
            const choicesEl = document.getElementById('choices');
            choicesEl.innerHTML = '';
            choices.forEach(choice => {
                const btn = document.createElement('button');
                btn.textContent = choice.text;
                btn.onclick = () => {
                    playSound('click');
                    if (choice.puzzle) {
                        showPuzzle(choice.puzzle);
                    } else {
                        gameState.score += 100;
                        if (choice.next) showScene(choice.next);
                    }
                    updateUI();
                };
                choicesEl.appendChild(btn);
            });
        }

        function showPuzzle(type) {
            document.getElementById('game-content').style.display = 'none';
            document.getElementById('puzzle-screen').classList.add('active');
            
            const puzzle = puzzles[type][Math.floor(Math.random() * puzzles[type].length)];
            gameState.currentPuzzle = puzzle;
            
            document.getElementById('puzzle-question').textContent = puzzle.q;
            document.getElementById('puzzle-hint').textContent = puzzle.hint;
            document.getElementById('puzzle-input').value = '';
            document.getElementById('puzzle-input').focus();
        }

        function checkPuzzleAnswer() {
            const answer = document.getElementById('puzzle-input').value.trim().toLowerCase();
            if (answer === gameState.currentPuzzle.a.toLowerCase()) {
                playSound('success');
                gameState.magicItems++;
                gameState.score += 500;
                showEffect('‚úÖ –ê–†–¢–ï–§–ê–ö–¢ +1!', 'success');
                setTimeout(() => backFromPuzzle(), 1500);
            } else {
                playSound('fail');
                gameState.characters.vova.age = Math.max(2, gameState.characters.vova.age - 2);
                showEffect('‚ùå –í–æ–∑—Ä–∞—Å—Ç -2 –≥–æ–¥–∞!', 'danger');
            }
            updateUI();
        }

        function backFromPuzzle() {
            document.getElementById('puzzle-screen').classList.remove('active');
            document.getElementById('game-content').style.display = 'block';
            showScene('school1');
        }

        function showEffect(text, type) {
            const effect = document.createElement('div');
            effect.style.cssText = `
                position:fixed;top:40%;left:50%;transform:translateX(-50%);
                font-size:3em;font-weight:bold;color:${type === 'success' ? '#27ae60' : '#e74c3c'};
                text-shadow:0 0 20px currentColor;padding:20px;border-radius:20px;z-index:10000;
                animation:popEffect 2s forwards`;
            effect.textContent = text;
            document.body.appendChild(effect);
            setTimeout(() => effect.remove(), 2000);
        }

        function randomAges() {
            const ages = [2, 9, 15, 17];
            Object.values(gameState.characters).forEach(char => {
                char.age = ages[Math.floor(Math.random() * 4)];
            });
            updateUI();
        }

        function updateUI() {
            // –ü–µ—Ä—Å–æ–Ω–∞–∂–∏
            const charsEl = document.getElementById('characters');
            charsEl.innerHTML = '';
            Object.values(gameState.characters).forEach(char => {
                const card = document.createElement('div');
                card.className = `character-card age-${char.age}`;
                card.innerHTML = `
                    <div style="font-size:3em">${char.emoji}</div>
                    <div style="font-size:1.3em;font-weight:bold">${char.name}</div>
                    <div style="font-size:2.5em">${char.age} –ª–µ—Ç</div>
                `;
                charsEl.appendChild(card);
            });

            // –°—Ç–∞—Ç—É—Å
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('magic-count').textContent = `${gameState.magicItems}/6`;
            document.getElementById('score-value').textContent = gameState.score;

            // –ü—Ä–æ–≥—Ä–µ—Å—Å
            const progress = Math.min(95, (gameState.level / 25) * 100);
            document.getElementById('progress-fill').style.width = progress + '%';
        }

        function updateTimer() {
            gameState.playTime++;
        }

        // Enter –¥–ª—è –∑–∞–¥–∞—á–µ–∫
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && document.getElementById('puzzle-screen').classList.contains('active')) {
                checkPuzzleAnswer();
            }
        });

        // ‚úÖ –°–¢–ê–†–¢
        window.onload = function() {
            console.log('üéÆ –ò–ì–†–ê –ì–û–¢–û–í–ê!');
            initGame();
        };
    </script>
</head>
<body>

