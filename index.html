<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ –ü–µ—Ä–µ–≤–µ—Ä—Ç—ã—à: –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –í–æ–∑—Ä–∞—Å—Ç–æ–≤ (–ò–°–ü–†–ê–í–õ–ï–ù–û)</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            background:linear-gradient(-45deg,#ff9a9e,#fecfef,#fecfef,#ff9a9e);
            background-size:400% 400%;
            animation:gradientShift 15s ease infinite;
            color:#333;
            font-family:'Comic Sans MS',cursive;
            min-height:100vh;
            overflow-x:hidden
        }
        @keyframes gradientShift{
            0%,100%{background-position:0% 50%}
            50%{background-position:100% 50%}
        }
        .container{max-width:1000px;margin:0 auto;padding:20px}
        .header{
            text-align:center;
            background:linear-gradient(90deg,#ffd700,#ff6b35,#ffd700);
            -webkit-background-clip:text;
            -webkit-text-fill-color:transparent;
            font-size:3em;margin:20px 0;
            text-shadow:0 0 30px rgba(255,215,0,0.8);
            animation:pulse 2s infinite
        }
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .status-bar{
            display:grid;grid-template-columns:1fr 1fr 1fr;gap:15px;
            background:#fff8dc;border-radius:25px;padding:20px;margin:20px 0;
            box-shadow:0 15px 40px rgba(0,0,0,0.2)
        }
        .stat-card{background:#fff;border-radius:15px;padding:15px;text-align:center;
            box-shadow:0 8px 25px rgba(0,0,0,0.1);transition:all 0.3s}
        .stat-card:hover{transform:translateY(-5px)}
        .character-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin:20px 0}
        .character-card{
            background:#fff;border-radius:20px;padding:20px;text-align:center;
            box-shadow:0 10px 30px rgba(0,0,0,0.15);position:relative;
            transition:all 0.4s ease;overflow:hidden
        }
        .character-card:hover{transform:scale(1.05) rotate(1deg)}
        .age-2{background:linear-gradient(135deg,#ffe4b5,#ffdab9)}
        .age-9{background:linear-gradient(135deg,#b8e6b8,#98d8a8)}
        .age-15{background:linear-gradient(135deg,#a8d5e2,#87c5d2)}
        .age-17{background:linear-gradient(135deg,#f4b6c2,#e8a2b0)}
        .scene-text{
            background:#fff;border-radius:25px;padding:30px;margin:25px 0;
            font-size:1.4em;line-height:1.8;box-shadow:0 20px 50px rgba(0,0,0,0.2);
            min-height:250px;max-height:400px;overflow-y:auto;
            white-space: pre-wrap; /* ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –§–ò–ö–° */
            line-height: 1.6;
        }
        .typewriter{overflow:hidden;border-right:.2em solid #ffd700}
        .highlight{color:#ff6b35;font-weight:bold;text-shadow:0 0 10px #ff6b35}
        .danger{color:#e74c3c;font-weight:bold}
        .success{color:#27ae60;font-weight:bold}
        .choices{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin:30px 0}
        button{
            background:linear-gradient(45deg,#ff6b35,#f7931e,#ff6b35);
            color:white;border:none;border-radius:30px;padding:20px 35px;
            font-size:1.3em;font-weight:bold;cursor:pointer;transition:all 0.3s;
            box-shadow:0 10px 30px rgba(255,107,53,0.4);font-family:'Comic Sans MS',cursive
        }
        button:hover{
            transform:translateY(-5px) scale(1.05);
            box-shadow:0 15px 40px rgba(255,107,53,0.6)
        }
        button:disabled{background:#bdc3c7;transform:none;cursor:not-allowed;box-shadow:none}
        .age-effect{
            position:fixed;top:30%;left:50%;transform:translateX(-50%);
            font-size:4em;font-weight:bold;color:#ffd700;text-shadow:0 0 40px #ffd700;
            pointer-events:none;animation:agePop 3s ease-out forwards;z-index:1000
        }
        @keyframes agePop{
            0%{opacity:0;transform:translateX(-50%) translateY(-100px) scale(0.3)}
            30%{opacity:1;transform:translateX(-50%) translateY(0) scale(1.3)}
            100%{opacity:0;transform:translateX(-50%) translateY(-50px) scale(1.1)}
        }
        .hidden{display:none !important}
        .progress-bar{
            width:100%;height:20px;background:#ddd;border-radius:10px;
            overflow:hidden;margin:20px 0
        }
        .progress-fill{
            height:100%;background:linear-gradient(90deg,#27ae60,#2ecc71);
            width:0%;transition:width 1s ease;border-radius:10px
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="header">üé≤ –ü–µ—Ä–µ–≤–µ—Ä—Ç—ã—à: –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –í–æ–∑—Ä–∞—Å—Ç–æ–≤</h1>
        
        <div class="status-bar">
            <div class="stat-card">
                <div style="font-size:2em">üåü</div>
                <div>–£—Ä–æ–≤–µ–Ω—å</div>
                <div id="level" style="font-size:2.5em;font-weight:bold">1</div>
            </div>
            <div class="stat-card">
                <div style="font-size:2em">üïê</div>
                <div>–ü—Ä–µ–¥–º–µ—Ç—ã</div>
                <div id="magic-count" style="font-size:2.5em;font-weight:bold">0/5</div>
            </div>
            <div class="stat-card">
                <div style="font-size:2em">‚≠ê</div>
                <div>–û—á–∫–∏</div>
                <div id="score-value" style="font-size:2.5em;font-weight:bold">0</div>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>

        <div class="character-grid" id="characters"></div>
        
        <div id="scene" class="scene-text"></div>
        <div id="choices" class="choices"></div>
    </div>

    <div id="victory-screen" class="victory-screen hidden">
        <h2 style="font-size:4em;margin:20px">üéâ –≠–ü–ò–ß–ù–ê–Ø –ü–û–ë–ï–î–ê! üéâ</h2>
        <p style="font-size:1.5em;margin:30px;max-width:600px;line-height:1.6">
            –í—ã —Å–æ–±—Ä–∞–ª–∏ –≤—Å–µ 5 –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤, –ø–æ–±–µ–¥–∏–ª–∏ –∑–ª–æ–¥–µ–µ–≤-—Å–æ—Å–µ–¥–µ–π 
            –∏ –≤–µ—Ä–Ω—É–ª–∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –≤–æ–∑—Ä–∞—Å—Ç—ã –≤—Å–µ–º –¥—Ä—É–∑—å—è–º!
            <br><br>–î—Ä—É–∂–±–∞ –ø–æ–±–µ–¥–∏–ª–∞ –º–∞–≥–∏—é! üèÜ‚ú®
        </p>
        <div style="font-size:3em;margin:30px">–í—Ä–µ–º—è –∏–≥—Ä—ã: <span id="playtime">00:00</span></div>
        <button onclick="location.reload()" style="font-size:1.5em;padding:25px 50px">
            üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞!
        </button>
    </div>

    <script>
        const gameState = {
            level: 1,
            score: 0,
            magicItems: 0,
            currentScene: 'start',
            playTime: 0,
            characters: {
                vova: {name: 'üë®‚Äçüíª –í–æ–≤–∞', age: 17, baseAge: 17, skills: ['–∏–≥—Ä—ã', '—Å–ø–æ—Ä—Ç'], emoji: 'üë®‚Äçüíª'},
                arseniy: {name: 'üé∏ –ê—Ä—Å–µ–Ω–∏–π', age: 15, baseAge: 15, skills: ['–º—É–∑—ã–∫–∞', '—Ç–∞–Ω—Ü—ã'], emoji: 'üé∏'},
                bogdan: {name: 'üîç –ë–æ–≥–¥–∞–Ω', age: 9, baseAge: 9, skills: ['–≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏'], emoji: 'üîç'},
                mark: {name: 'üçº –ú–∞—Ä–∫', age: 2, baseAge: 2, skills: ['–∏–≥—Ä–∞—Ç—å'], emoji: 'üçº'}
            }
        };

        const scenes = {
            start: {
                text: `üå≥ –ì–û–†–°–ö–û–ô –ü–ê–†–ö ‚Äî —è—Ä–∫–∏–π —Å–æ–ª–Ω–µ—á–Ω—ã–π –¥–µ–Ω—å!

–í–æ–≤–∞(17) –∏–≥—Ä–∞–µ—Ç –≤ —Ñ—É—Ç–±–æ–ª, –ê—Ä—Å–µ–Ω–∏–π(15) —Å–ª—É—à–∞–µ—Ç –º—É–∑—ã–∫—É —á–µ—Ä–µ–∑ –Ω–∞—É—à–Ω–∏–∫–∏,

–ë–æ–≥–¥–∞–Ω(9) —Å–æ–±–∏—Ä–∞–µ—Ç –ø–∞–∑–ª –Ω–∞ —Å–∫–∞–º–µ–π–∫–µ, –ú–∞—Ä–∫(2) –≤–µ—Å–µ–ª–æ –ø–æ–ª–∑–∞–µ—Ç –ø–æ —Ç—Ä–∞–≤–µ. üòÇ

–í–¥—Ä—É–≥ –≤ –∫—É—Å—Ç–∞—Ö –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–≤–µ—Ç–∏—Ç—å—Å—è –°–¢–†–ê–ù–ù–´–ï –ß–ê–°–´...

üåÄ –í–æ–∑—Ä–∞—Å—Ç—ã –≤–æ—Ç-–≤–æ—Ç –∏–∑–º–µ–Ω—è—Ç—Å—è! –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –∫–æ–º–∞–Ω–¥–∞?!`,
                choices: [
                    {text: "üïê –ü–æ–¥–æ–π—Ç–∏ –∫ –º–∞–≥–∏—á–µ—Å–∫–∏–º —á–∞—Å–∞–º", next: 'touchClock'},
                    {text: "üèÉ‚Äç‚ôÇÔ∏è –ë—ã—Å—Ç—Ä–æ –±–µ–∂–∞—Ç—å –¥–æ–º–æ–π!", next: 'runHome'},
                    {text: "üîç –ë–æ–≥–¥–∞–Ω –∏—Å—Å–ª–µ–¥—É–µ—Ç –∫—É—Å—Ç—ã", next: 'investigate'}
                ]
            },
            touchClock: {
                text: `üåÄ –ë–ê-–ë–ê-–ë–ê–•! ‚ö° –ú–∞–≥–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç —Å—Ä–∞–±–æ—Ç–∞–ª!

–í–æ–≤–∞ —Å—Ç–∞–ª 2 –ª–µ—Ç, –ú–∞—Ä–∫ ‚Äî 17 –ª–µ—Ç!
–ê—Ä—Å–µ–Ω–∏–π(15) ‚Üí 9 –ª–µ—Ç, –ë–æ–≥–¥–∞–Ω(9) ‚Üí 15 –ª–µ—Ç! üòÇü§Ø

–ó–≤–æ–Ω–æ–∫ –∏–∑ —à–∫–æ–ª—ã! –ù–∞–¥–æ —Å—Ä–æ—á–Ω–æ —Ç—É–¥–∞ ‚Äî —É—Ä–æ–∫ –Ω–∞—á–∞–ª—Å—è!`,
                effect: 'randomize',
                choices: [{text: "üè´ –ë–µ–∂–∏–º –≤ —à–∫–æ–ª—É!", next: 'school1'}]
            },
            school1: {
                text: `üè´ –®–ö–û–õ–ê ‚Äî —É—Ä–æ–∫ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –≤ —Å–∞–º–æ–º —Ä–∞–∑–≥–∞—Ä–µ!

–ú–∞—Ä–∫(17) –ª–µ–≥–∫–æ –ø–∏—à–µ—Ç —Ñ–æ—Ä–º—É–ª—ã –Ω–∞ –¥–æ—Å–∫–µ, –í–æ–≤–∞(2) –ø–ª–∞—á–µ—Ç –Ω–∞ –ø–æ–ª—É üò≠
–£—á–∏—Ç–µ–ª—å –≤ —à–æ–∫–µ: "–ö—Ç–æ –≤—ã —Ç–∞–∫–∏–µ?! –ì–¥–µ –≤–∞—à–∏ —Ç–µ—Ç—Ä–∞–¥–∏?!"

–ö—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –∑–∞–¥–∞—á–µ–π?`,
                choices: [
                    {text: "üìö –ú–∞—Ä–∫ —Ä–µ—à–∞–µ—Ç —É—Ä–∞–≤–Ω–µ–Ω–∏–µ", next: 'solveMath1', req: {char: 'mark', age: 17}, reward: true},
                    {text: "ü™ú –í–æ–≤–∞ –ª–µ–∑–µ—Ç –Ω–∞ –ø–∞—Ä—Ç—É", next: 'climbDesk', req: {char: 'vova', age: 2}},
                    {text: "üéµ –ê—Ä—Å–µ–Ω–∏–π —Ç–∞–Ω—Ü—É–µ—Ç –æ—Ç–≤–ª–µ—á–µ–Ω–∏–µ", next: 'danceDistraction1', req: {char: 'arseniy', age: 9}}
                ]
            },
            solveMath1: {
                text: `‚úÖ –ú–∞—Ä–∫ —Ä–µ—à–∏–ª —Å–ª–æ–∂–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ! +250 –æ—á–∫–æ–≤ ‚≠ê

–£—á–∏—Ç–µ–ª—å –≤ —à–æ–∫–µ! –î–æ—Å—Ç–∞–ª –∏–∑ —è—â–∏–∫–∞ –ú–ê–ì–ò–ß–ï–°–ö–ò–ô –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†!

–≠—Ç–æ –ø–µ—Ä–≤—ã–π –∏–∑ 5 –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤! üéâ

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ!`,
                reward: true,
                choices: [{text: "‚û°Ô∏è –ò–¥–µ–º –≤ —Å—Ç–æ–ª–æ–≤—É—é", next: 'schoolCanteen'}]
            },
            schoolCanteen: {
                text: `üè™ –®–ö–û–õ–¨–ù–ê–Ø –°–¢–û–õ–û–í–ê–Ø

–í–æ–≤–∞(2) –Ω–µ –¥–æ—Å—Ç–∞–µ—Ç –¥–æ —Å–æ–∫–∞ üò¢, –ë–æ–≥–¥–∞–Ω(15) —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–∞—Ä–æ–º! üòÇ

–ù–∞–¥–æ —á—Ç–æ-—Ç–æ –ø—Ä–∏–¥—É–º–∞—Ç—å, —á—Ç–æ–±—ã –ø–æ–µ—Å—Ç—å –∏ –¥–≤–∏–Ω—É—Ç—å—Å—è –¥–∞–ª—å—à–µ!`,
                choices: [
                    {text: "ü•§ –í–æ–≤–∞ —Ç—è–Ω–µ—Ç—Å—è –∑–∞ —Å–æ–∫–æ–º", next: 'juicePuzzle', req: {char: 'vova', age: 2}},
                    {text: "üç≤ –ë–æ–≥–¥–∞–Ω –≥–æ—Ç–æ–≤–∏—Ç –æ–±–µ–¥", next: 'cookingMinigame', req: {char: 'bogdan', age: 15}},
                    {text: "üõí –ö—É–ø–∏—Ç—å –±—É–ª–æ—á–∫—É", next: 'buyBun'}
                ]
            }
        };

        function initGame() {
            document.getElementById('victory-screen').classList.add('hidden');
            updateTimer();
            updateCharacters();
            updateStatus();
            showScene('start');
        }

        function showScene(sceneId) {
            let scene = scenes[sceneId] || generateRandomScene(sceneId);
            gameState.currentScene = sceneId;
            gameState.level = Math.min(20, gameState.level + 1);
            
            const sceneEl = document.getElementById('scene');
            sceneEl.innerHTML = '';
            sceneEl.classList.add('typewriter');
            
            typeWriter(scene.text, sceneEl, () => {
                sceneEl.classList.remove('typewriter');
                showChoices(scene.choices);
                if (scene.effect === 'randomize') randomizeAges();
            });
        }

        function typeWriter(text, element, callback) {
            element.innerHTML = '';
            let i = 0;
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, 50);
                } else if (callback) {
                    callback();
                }
            }
            type();
        }

        function showChoices(choices) {
            const choicesEl = document.getElementById('choices');
            choicesEl.innerHTML = '';
            
            choices.forEach(choice => {
                const btn = document.createElement('button');
                btn.innerText = choice.text;
                
                const canUse = !choice.req || checkRequirement(choice.req);
                btn.disabled = !canUse;
                btn.title = !canUse ? `–ù—É–∂–µ–Ω ${choice.req.char} ${choice.req.age} –ª–µ—Ç` : '';
                
                btn.onclick = () => handleChoice(choice);
                choicesEl.appendChild(btn);
            });
        }

        function checkRequirement(req) {
            return gameState.characters[req.char].age === req.age;
        }

        function handleChoice(choice) {
            const btn = event.target;
            btn.style.transform = 'scale(0.95)';
            setTimeout(() => btn.style.transform = '', 150);
            
            if (choice.reward) {
                gameState.magicItems = Math.min(5, gameState.magicItems + 1);
                gameState.score += 250;
            }
            gameState.score += 100;
            
            setTimeout(() => {
                if (choice.next) {
                    if (choice.next.includes('victory') && gameState.magicItems >= 5) {
                        showVictory();
                    } else {
                        showScene(choice.next);
                    }
                }
            }, 1200);
            
            updateStatus();
            updateCharacters();
        }

        function randomizeAges() {
            const ages = [2, 9, 15, 17];
            Object.values(gameState.characters).forEach((char, i) => {
                char.age = ages[Math.floor(Math.random() * ages.length)];
                setTimeout(() => showAgeEffect(char.name, char.age), i * 400);
            });
        }

        function showAgeEffect(name, age) {
            const effect = document.createElement('div');
            effect.className = 'age-effect';
            effect.innerHTML = `${name} ‚Üí ${age} –ª–µ—Ç!`;
            document.body.appendChild(effect);
            setTimeout(() => effect.remove(), 3000);
        }

        function generateRandomScene(sceneId) {
            const locations = ['–¢–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä', '–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞', '–°–ø–æ—Ä—Ç–ø–ª–æ—â–∞–¥–∫–∞', '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è'];
            return {
                text: `üåÜ ${locations[Math.floor(Math.random()*4)]}

–ö–æ–º–∞–Ω–¥–∞ –≤ –Ω–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏! –ù—É–∂–Ω—ã –Ω–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è.

–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≥–µ—Ä–æ—è –¥–ª—è –∑–∞–¥–∞—á–∏!`,
                choices: [
                    {text: "üë®‚Äçüíª –í–æ–≤–∞ —Ä–µ—à–∞–µ—Ç —Ç–µ—Ö. –ø—Ä–æ–±–ª–µ–º—É", next: 'techScene'},
                    {text: "üé∏ –ê—Ä—Å–µ–Ω–∏–π –≤—ã—Å—Ç—É–ø–∞–µ—Ç", next: 'danceScene'},
                    {text: "üîç –ë–æ–≥–¥–∞–Ω —Å–æ–±–∏—Ä–∞–µ—Ç –ø–∞–∑–ª", next: 'logicScene'},
                    {text: "üçº –ú–∞—Ä–∫ –Ω–∞—Ö–æ–¥–∏—Ç –ª–∞–∑–µ–π–∫—É", next: 'babyScene'}
                ]
            };
        }

        function updateCharacters() {
            const container = document.getElementById('characters');
            container.innerHTML = '';
            Object.values(gameState.characters).forEach(char => {
                const card = document.createElement('div');
                card.className = `character-card age-${char.age}`;
                card.innerHTML = `
                    <div style="font-size:3em">${char.emoji}</div>
                    <div style="font-size:1.3em;font-weight:bold">${char.name}</div>
                    <div style="font-size:2.8em">${char.age}<span style="font-size:0.5em">–ª–µ—Ç</span></div>
                `;
                container.appendChild(card);
            });
        }

        function updateStatus() {
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('magic-count').textContent = `${gameState.magicItems}/5`;
            document.getElementById('score-value').textContent = gameState.score.toLocaleString();
            document.getElementById('progress-fill').style.width = Math.min(95, (gameState.level / 20) * 100) + '%';
        }

        function updateTimer() {
            gameState.playTime++;
            if (document.getElementById('playtime')) {
                document.getElementById('playtime').textContent = 
                    new Date(gameState.playTime * 1000).toISOString().substr(14, 5);
            }
        }
        setInterval(updateTimer, 1000);

        function showVictory() {
            document.querySelector('.container').style.display = 'none';
            document.getElementById('victory-screen').classList.remove('hidden');
        }

        window.onload = initGame;
    </script>
</body>
</html>

