<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ –ü–µ—Ä–µ–≤–µ—Ä—Ç—ã—à: –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –í–æ–∑—Ä–∞—Å—Ç–æ–≤</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            background:linear-gradient(45deg,#ff9a9e,#fecfef,#fecfef,#ff9a9e);
            color:#333;
            font-family:'Comic Sans MS',cursive;
            min-height:100vh;
            overflow-x:hidden;
            animation:sparkle 20s infinite linear
        }
        @keyframes sparkle{
            0%,100%{background-position:0% 50%}
            50%{background-position:100% 50%}
        }
        .container{max-width:900px;margin:0 auto;padding:20px}
        .header{
            text-align:center;
            background:linear-gradient(90deg,#ffd700,#ff6b35,#ffd700);
            -webkit-background-clip:text;
            -webkit-text-fill-color:transparent;
            background-clip:text;
            font-size:2.5em;
            margin-bottom:20px;
            text-shadow:0 0 20px rgba(255,215,0,0.8)
        }
        .status-bar{
            display:flex;justify-content:space-between;align-items:center;
            background:#fff8dc;border-radius:20px;padding:15px;margin:20px 0;
            box-shadow:0 10px 30px rgba(0,0,0,0.2)
        }
        .character-card{
            background:#fff;border-radius:15px;padding:10px;
            text-align:center;box-shadow:0 5px 15px rgba(0,0,0,0.1);
            transition:all 0.3s ease
        }
        .character-card:hover{transform:scale(1.05)}
        .character-card.age-2{background:#ffe4b5}
        .character-card.age-9{background:#b8e6b8}
        .character-card.age-15{background:#a8d5e2}
        .character-card.age-17{background:#f4b6c2}
        .scene-text{
            background:#fff;border-radius:20px;padding:25px;
            font-size:1.3em;line-height:1.6;
            margin:20px 0;box-shadow:0 15px 40px rgba(0,0,0,0.15);
            min-height:200px;max-height:300px;overflow-y:auto
        }
        .typewriter{overflow:hidden;border-right:.15em solid #ffd700;white-space:nowrap}
        .choices{display:flex;flex-direction:column;gap:15px;margin:25px 0}
        button{
            background:linear-gradient(45deg,#ff6b35,#f7931e);
            color:white;border:none;border-radius:25px;
            padding:18px 30px;font-size:1.2em;font-weight:bold;
            cursor:pointer;transition:all 0.3s ease;
            box-shadow:0 8px 25px rgba(255,107,53,0.4);
            font-family:'Comic Sans MS',cursive
        }
        button:hover{
            transform:translateY(-3px);
            box-shadow:0 12px 35px rgba(255,107,53,0.6);
            background:linear-gradient(45deg,#ff8e53,#ffb347)
        }
        button:disabled{background:#ccc;transform:none;cursor:not-allowed}
        .age-effect{
            position:fixed;top:20%;left:50%;transform:translateX(-50%);
            font-size:3em;font-weight:bold;color:#ffd700;
            text-shadow:0 0 30px #ffd700;pointer-events:none;
            animation:agePop 2s ease-out forwards;z-index:1000
        }
        @keyframes agePop{
            0%{opacity:0;transform:translateX(-50%) translateY(-50px) scale(0.5)}
            50%{opacity:1;transform:translateX(-50%) translateY(0) scale(1.2)}
            100%{opacity:0;transform:translateX(-50%) translateY(-30px) scale(1)}
        }
        .hidden{display:none}
        .victory-screen,.defeat-screen{
            position:fixed;top:0;left:0;width:100%;height:100vh;
            background:rgba(0,0,0,0.9);color:white;text-align:center;
            display:flex;flex-direction:column;justify-content:center;align-items:center;
            font-size:2em;z-index:10000
        }
        .emoji-rain{position:fixed;width:100%;height:100vh;pointer-events:none;top:0;left:0}
        .emoji{position:absolute;font-size:2em;animation:fall 3s linear infinite}
        @keyframes fall{
            0%{transform:translateY(-100vh) rotate(0deg)}
            100%{transform:translateY(100vh) rotate(360deg)}
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="header">üé≤ –ü–µ—Ä–µ–≤–µ—Ä—Ç—ã—à: –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –í–æ–∑—Ä–∞—Å—Ç–æ–≤</h1>
        
        <div class="status-bar">
            <div id="progress">üåü –£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span>/5</div>
            <div id="magic-objects">üïê –ú–∞–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã: <span id="magic-count">0</span>/3</div>
            <div id="score">‚≠ê –û—á–∫–∏: <span id="score-value">0</span></div>
        </div>

        <div id="characters"></div>
        
        <div id="scene" class="scene-text"></div>
        <div id="choices" class="choices"></div>
    </div>

    <div id="victory-screen" class="victory-screen hidden">
        <h2>üéâ –ü–û–ë–ï–î–ê! üéâ</h2>
        <p>–í—ã –ø–æ–±–µ–¥–∏–ª–∏ –∑–ª–æ–¥–µ–µ–≤-—Å–æ—Å–µ–¥–µ–π –∏ –≤–µ—Ä–Ω—É–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –≤–æ–∑—Ä–∞—Å—Ç–æ–≤!</p>
        <button onclick="location.reload()">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞! üéÆ</button>
    </div>

    <script>
        const gameState = {
            level: 1,
            score: 0,
            magicItems: 0,
            currentScene: 'start',
            characters: {
                vova: {name: '–í–æ–≤–∞', age: 17, baseAge: 17, skills: ['–∏–≥—Ä—ã', '—Å–ø–æ—Ä—Ç']},
                arseniy: {name: '–ê—Ä—Å–µ–Ω–∏–π', age: 15, baseAge: 15, skills: ['–º—É–∑—ã–∫–∞', '—Ç–∞–Ω—Ü—ã']},
                bogdan: {name: '–ë–æ–≥–¥–∞–Ω', age: 9, baseAge: 9, skills: ['–≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏', '–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è']},
                mark: {name: '–ú–∞—Ä–∫', age: 2, baseAge: 2, skills: ['–∏–≥—Ä–∞—Ç—å', '–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å']}
            }
        };

        const scenes = {
            start: {
                text: [
                    "üåÜ <span class='highlight'>–ü–ê–†–ö</span> ‚Äî —Å–æ–ª–Ω–µ—á–Ω—ã–π –¥–µ–Ω—å!",
                    "–ß–µ—Ç–≤–µ—Ä–æ –¥—Ä—É–∑–µ–π –≥—É–ª—è—é—Ç: –í–æ–≤–∞(17), –ê—Ä—Å–µ–Ω–∏–π(15), –ë–æ–≥–¥–∞–Ω(9), –ú–∞—Ä–∫(2).",
                    "‚ùì –í–¥—Ä—É–≥ <span class='danger'>–°–¢–†–ê–ù–ù–´–ï –ß–ê–°–´</span> –≤ –∫—É—Å—Ç–∞—Ö –Ω–∞—á–∏–Ω–∞—é—Ç —Å–≤–µ—Ç–∏—Ç—å—Å—è...",
                    "üåÄ –í–û–ó–†–ê–°–¢–ê –ú–ï–ù–Ø–Æ–¢–°–Ø! –ß—Ç–æ –¥–µ–ª–∞—Ç—å?!"
                ],
                choices: [
                    {text: "üëâ –ü–æ–¥–æ–π—Ç–∏ –∫ —á–∞—Å–∞–º", next: 'touchClock'},
                    {text: "üèÉ –ë–µ–∂–∞—Ç—å –¥–æ–º–æ–π", next: 'runHome'},
                    {text: "üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å", next: 'investigate'}
                ]
            },
            touchClock: {
                text: ["üåÄ –ë–ê-–ë–ê–•! –í–æ–∑—Ä–∞—Å—Ç—ã –ø–µ—Ä–µ–º–µ—à–∞–ª–∏—Å—å!", "–í–æ–≤–∞ —Å—Ç–∞–ª 2 –ª–µ—Ç, –ú–∞—Ä–∫ ‚Äî 17!", "üòÇ –•–∞–æ—Å –∏ —Å–º–µ—Ö!"],
                effect: () => randomizeAges(),
                choices: [{text: "‚û°Ô∏è –í —à–∫–æ–ª—É", next: 'school'}]
            },
            school: {
                text: [
                    "üè´ <span class='highlight'>–®–ö–û–õ–ê</span> ‚Äî –∑–≤–æ–Ω–æ–∫ –Ω–∞ —É—Ä–æ–∫!",
                    "–í–æ–≤–∞(2 –≥–æ–¥–∞) –Ω–µ –º–æ–∂–µ—Ç –¥–æ—Ç—è–Ω—É—Ç—å—Å—è –¥–æ –¥–æ—Å–∫–∏ üò≠",
                    "–ú–∞—Ä–∫(17 –ª–µ—Ç) —Ä–µ—à–∞–µ—Ç —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–∞ 5 —Å–µ–∫! ü§ì"
                ],
                choices: [
                    {text: "üìö –ú–∞—Ä–∫ —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É", next: 'solveMath', skillReq: 'mark', ageReq: 17},
                    {text: "ü™ú –í–æ–≤–∞ –ª–µ–∑–µ—Ç –Ω–∞ —Å—Ç—É–ª", next: 'climbChair', skillReq: 'vova', ageReq: 2},
                    {text: "üéµ –ê—Ä—Å–µ–Ω–∏–π –æ—Ç–≤–ª–µ–∫–∞–µ—Ç —É—á–∏—Ç–µ–ª—è", next: 'danceDistraction'}
                ]
            }
        };

        // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
        const allScenes = ['school', 'mall', 'library', 'bossFight', 'victory'];
        
        function initGame() {
            updateCharacters();
            updateStatus();
            showScene('start');
        }

        function showScene(sceneId) {
            const scene = scenes[sceneId] || generateRandomScene();
            gameState.currentScene = sceneId;
            
            const sceneEl = document.getElementById('scene');
            sceneEl.innerHTML = '';
            sceneEl.classList.add('typewriter');
            
            typeWriter(scene.text.join('<br>'), sceneEl, () => {
                sceneEl.classList.remove('typewriter');
                showChoices(scene.choices);
                if (scene.effect) scene.effect();
            });
        }

        function typeWriter(text, element, callback) {
            element.innerHTML = text;
            element.innerHTML = '';
            let i = 0;
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, 50);
                } else {
                    callback();
                }
            }
            type();
        }

        function showChoices(choices) {
            const choicesEl = document.getElementById('choices');
            choicesEl.innerHTML = '';
            
            choices.forEach(choice => {
                const btn = document.createElement('button');
                btn.innerText = choice.text;
                
                if (choice.skillReq && choice.ageReq) {
                    btn.disabled = !canUseChoice(choice);
                    btn.title = btn.disabled ? '–ù—É–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç!' : '';
                }
                
                btn.onclick = () => handleChoice(choice);
                choicesEl.appendChild(btn);
            });
        }

        function canUseChoice(choice) {
            const char = gameState.characters[choice.skillReq];
            return char.age === choice.ageReq;
        }

        function handleChoice(choice) {
            if (choice.next) {
                if (choice.next === 'victory' && gameState.magicItems >= 3) {
                    showVictory();
                } else {
                    gameState.level++;
                    showScene(choice.next);
                }
            }
            
            if (choice.reward) {
                gameState.magicItems++;
                gameState.score += 100;
            }
            
            updateStatus();
        }

        function randomizeAges() {
            Object.values(gameState.characters).forEach(char => {
                const ages = [2, 9, 15, 17];
                char.age = ages[Math.floor(Math.random() * ages.length)];
                showAgeEffect(char.name, char.age);
            });
        }

        function showAgeEffect(name, age) {
            const effect = document.createElement('div');
            effect.className = 'age-effect';
            effect.textContent = `${name}: ${age} –ª–µ—Ç!`;
            document.body.appendChild(effect);
            setTimeout(() => effect.remove(), 2000);
        }

        function updateCharacters() {
            const container = document.getElementById('characters');
            container.innerHTML = '';
            
            Object.values(gameState.characters).forEach(char => {
                const card = document.createElement('div');
                card.className = `character-card age-${char.age}`;
                card.innerHTML = `
                    <div style="font-size:1.5em;font-weight:bold">${char.emoji || 'üë¶'}</div>
                    <div>${char.name}</div>
                    <div style="font-size:2em">${char.age} –ª–µ—Ç</div>
                `;
                container.appendChild(card);
            });
        }

        function updateStatus() {
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('magic-count').textContent = gameState.magicItems;
            document.getElementById('score-value').textContent = gameState.score;
        }

        function generateRandomScene() {
            const locations = ['mall', 'library', 'park', 'bossFight'];
            return {
                text: [`üåü <span class="highlight">${locations[Math.floor(Math.random()*locations.length)]}</span> ‚Äî –Ω–æ–≤—ã–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –∂–¥—É—Ç!`],
                choices: [{text: "‚û°Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—É—Ç—å", next: allScenes[Math.floor(Math.random()*allScenes.length)]}]
            };
        }

        function showVictory() {
            document.querySelector('.container').style.display = 'none';
            document.getElementById('victory-screen').classList.remove('hidden');
            createEmojiRain('üéâ','‚≠ê','üèÜ','‚ú®');
        }

        function createEmojiRain(...emojis) {
            const rain = document.createElement('div');
            rain.className = 'emoji-rain';
            document.body.appendChild(rain);
            
            function dropEmoji() {
                const emoji = document.createElement('div');
                emoji.className = 'emoji';
                emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                emoji.style.left = Math.random() * 100 + '%';
                emoji.style.animationDelay = Math.random() * 2 + 's';
                rain.appendChild(emoji);
                
                setTimeout(() => emoji.remove(), 3000);
            }
            
            const interval = setInterval(dropEmoji, 300);
            setTimeout(() => clearInterval(interval), 10000);
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        initGame();
    </script>
</body>
</html>
